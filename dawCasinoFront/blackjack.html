<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BlackJack - DAW Casino</title>
    <link rel="stylesheet" href="assets/css/game.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>â™ ï¸</text></svg>">
</head>
<body>

    <div class="main-layout">
        <aside class="sidebar">
            <h3>ğŸ“œ Historial</h3>
            <div id="history-list" class="history-container"><p class="loading-text">Cargando...</p></div>
            <button class="btn-secondary small" onclick="endSession()">â¹ Terminar SesiÃ³n</button>
        </aside>

        <main class="game-wrapper">
            <header class="game-header">
                <div class="timer-badge">â± <span id="session-timer">00:00</span></div>
                <div class="user-profile-display">
                    <span id="username-display">Jugador</span>
                    <img id="header-avatar" src="" class="avatar-icon hidden">
                </div>
                <div class="balance-container">
                    <div class="balance-badge"><span id="balance-display">0</span> â‚¬</div>
                    <button class="btn-deposit" onclick="depositMoney()" title="Ingresar dinero">+</button>
                </div>
            </header>

            <div class="casino-table">
                <div class="hand-section">
                    <h2>Banca <span id="dealer-score" class="score-badge">0</span></h2>
                    <div id="dealer-cards" class="cards-area"></div>
                </div>
                <hr class="divider">
                <div class="hand-section">
                    <h2>TÃº <span id="player-score" class="score-badge">0</span></h2>
                    <div id="player-cards" class="cards-area"></div>
                </div>
                <div id="status-message" class="status-overlay hidden"></div>
            </div>

            <div class="controls-area">
                <div id="bet-panel">
                    <label for="bet-amount" style="display:inline; margin-right:10px;">Apuesta:</label>
                    <input type="number" id="bet-amount" value="50" min="10" step="10">
                    <button class="btn-primary" style="width:auto; margin-top:0;" onclick="startGame()">Jugar Mano</button>
                </div>
                <div id="action-panel" class="hidden">
                    <button class="btn-action hit" onclick="hit()">Pedir (HIT)</button>
                    <button class="btn-action stand" onclick="stand()">Plantarse (STAND)</button>
                </div>
            </div>
        </main>
    </div>

    <div id="setup-modal" class="modal-overlay active">
        <div class="modal-content">
            <h2 style="color:var(--error); text-align:center;">ğŸ›¡ï¸ Juego Responsable</h2>
            <p style="text-align:center; color:#ddd; margin-bottom:20px;">
                Por tu seguridad, establece tus lÃ­mites para esta sesiÃ³n.
            </p>
            
            <div class="setup-section" style="background:rgba(0,0,0,0.3);">
                <label>â± LÃ­mite de Tiempo (minutos):</label>
                <input type="number" id="limit-time" value="30" min="5">
                
                <label style="margin-top:15px;">ğŸ’° LÃ­mite de PÃ©rdidas (â‚¬):</label>
                <input type="number" id="limit-loss" value="200" min="50">
                <small style="color:#aaa; display:block; margin-top:5px;">La sesiÃ³n se cerrarÃ¡ automÃ¡ticamente si pierdes esta cantidad.</small>
            </div>

            <div class="rules-summary" style="margin-top:20px; font-size:0.9rem; text-align:center;">
                <p>â„¹ï¸ Reglas: BlackJack paga <strong>2:1</strong>. Banca planta en <strong>17</strong>.</p>
            </div>

            <button class="btn-primary" onclick="startSessionConfig()" style="margin-top:20px;">âœ… Aceptar y Jugar</button>
            <button class="btn-secondary" onclick="window.location.href='index.html'" style="width:100%; margin-top:10px;">ğŸ  Volver al Lobby</button>
        </div>
    </div>

    <div id="summary-modal" class="modal-overlay">
        <div class="modal-content">
            <h2>ğŸ“Š Resumen de SesiÃ³n</h2>
            <div class="summary-stats">
                <p>â³ Tiempo Jugado: <span id="summary-time">00:00</span></p>
                <p>ğŸ’° Saldo Inicial: <span id="summary-start">0</span> â‚¬</p>
                <p>ğŸ Saldo Final: <span id="summary-end">0</span> â‚¬</p>
                <h3 id="summary-result" class="win">Resultados Calculando...</h3>
            </div>
            <button class="btn-primary" onclick="window.location.href='index.html'">ğŸ  Volver al MenÃº</button>
            <button class="btn-secondary" onclick="location.reload()" style="width:100%; margin-top:10px;">ğŸ”„ Jugar de nuevo</button>
        </div>
    </div>

    <script src="assets/js/config.js"></script>
    <script src="assets/js/blackjack.js"></script>
</body>
</html>